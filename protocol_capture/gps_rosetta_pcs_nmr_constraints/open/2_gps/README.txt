******************************************************************************
Capturing Conformational States in Proteins Using Pseudocontact Shifts (PCS)

Author: Kala Bharath Pilla (kalabharath@gmail.com)
Protocol Validated by: : JKLeman (julia.koehler1982@gmail.com)
PIs: Gottfied Otting, *Thomas Huber (t.huber@anu.edu.au)

Publication describing the method:
Pilla KB, Koehler Leman J, Otting G, Huber T (2015)
Capturing Conformational States in Proteins Using Sparse Paramagnetic NMR Data. PLoS Comp Bio (In preparation)

*******************************************************************************

GPS Rosetta:
=====================

This is the production run that samples conformational space using Rosetta's ab initio protocol with PCS restraints from multiple tags.
Generate models typically in the order of tens of thousands. Recommended to run on a computer cluster.
Before you run this protocol, generate PCS weighting factors relative to Rosetta's centroid scoring function as described in '../1_weights/'


The order to run the script files:
-----------------------------
sh 1_Rosetta_gps.sh >output.txt (expected output files: dvp.silent, dvp_allatom.fsc)
sh 2_combined_allatom_pcs_score.sh (expected output files: dvp_combined_allatom_pcs.fsc)
sh 3_pcs_only.sh (expected output dvp_pcs_only.fsc)

Analysis:
=========

the script files would generate:

1_Rosetta_gps.sh:
-----------------
Takes in the sequence information, known structure, PCS data from more than 2 tags and directs the Rosetta's  conformational sampling to satisfy the input PCS restraints.
PCS restraints from multiple metal binding tags dramatically improves sampling over single metal center, the method dubbed GPS-Rosetta is given in (Yagi et al and Schmitz et al)
In this script, For protein system, the known part is fixed and the unknown structure is sampled with PCS restraints from 4 metal binding tags.These restraints are supplied via broker file '../setup/rigid_plus_pcs_broker.txt'. The script generates all-atom models. The given restraints are used in centroid mode which is followed by Rosetta's 'Fast Rleax' to generate all-atom models.
Since the PCS restraints are not used in Rosetta's 'Relax' protocol, the all-atom models should be rescored with PCS data.

2_combined_allatom_pcs_score.sh:
--------------------------------

This script scores the all-atom models generated from above to contain PCS restraint score terms. The score file has both Rosetta's all-atom score (Talaris2013) and PCS score terms from all metal tags.

3_pcs_only.sh
-------------
This script generates score files which contain PCS terms only. The pcs weights for each of the metal tags are set to unity.

Selection of Final Structures:
=============================

Select the final structures with lowest combined 'Rosetta and PCS energy' or Structures with low 'PCS energy'.
Keep sampling until the structures have converged to satisfy the input PCS restraints.


References:
==========
1. Schmitz C, Vernon R, Otting G, Baker D, Huber T (2012) Protein structure determination from pseudocontact shifts using ROSETTA. J Mol Biol 416: 668–677. doi:10.1016/j.jmb.2011.12.056.
2. Yagi H, Pilla KB, Maleckis A, Graham B, Huber T, et al. (2013) Three-dimensional protein fold determination from backbone amide pseudocontact shifts generated by lanthanide tags at multiple sites. Structure 21: 883–890. doi:10.1016/j.str.2013.04.001.
