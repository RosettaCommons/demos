******************************************************************************
Capturing Conformational States in Proteins Using Pseudocontact Shifts (PCS)

Author: Kala Bharath Pilla (kalabharath@gmail.com)
Protocol Validated by: : JKLeman (julia.koehler1982@gmail.com)
PIs: Gottfied Otting, *Thomas Huber (t.huber@anu.edu.au)

Publication describing the method:
Pilla KB, Koehler Leman J, Otting G, Huber T (2015)
Capturing Conformational States in Proteins Using Sparse Paramagnetic NMR Data. PLoS Comp Bio (In preparation)

*******************************************************************************

Calculate PCS weights:
=====================

The weighting factor (w) for each of the  metal centers was calculated by generating 1000 structures without PCS restraints, followed by calculation of (w) using

w = [(a_high - a_low)/(c_high - c_low)]/ntags    [1]

where 'a_high' and 'a_low' are the averages of the highest and lowest 10% of the values of the Rosetta ab inito score and 'c_high' and 'c_low' are the averages of the highest and lowest 10% of the PCS energy score value obtained by rescoring 1000 decoys with a unity PCS weighting factor.'ntags'are total number of metal centers. For PCS energy rescoring, the weighting factors were set to unity.

There are three script files to achieve the required weights for the example dengue NS2B-NS3 protease. The flags and fields required to modify to achieve for any system are detailed in individual script files.

1_Rosetta_wts.sh : Generates 1,000 decoy structures without any PCS restraints. The staring model is also given as input and the constant region in the target is defined using broker claimers. If backbone chemical shifts are measured they are used to generate fragments via 'Robetta server'.

2_rescore.sh : The 1000 decoy structures are scored with PCS data, setting weights to unity.

3_pcs_weights.py : The python script generates two weight files, 'pcs.wts' and 't13_pcs.wts' using equation[1]. 'pcs.wts' is used to patch the centroid scoring function in the low-resolution phase of fragment assembly step. 't13_pcs.wts' is used to rescore all-atom silent files with Talaris2013 wts along with pcsTs[1-4] wts.

The order to run script files:
-----------------------------

sh 1_Rosetta_wts.sh > output.txt (expected output files: dvp.silent, dvp_cs.csc)
sh 2_rescore.sh     (expected optput files: dvp_pcs.csc)
python 3_pcs_weights.py --csfile dvp_cs.csc --pcsfile dvp_pcs.csc --ntags 4 (expected output files: pcs.wts, t13_pcs.wts)

References:
==========
1. Kim DE, Chivian D, Baker D (2004) Protein structure prediction and analysis using the Robetta server. Nucleic Acids Res 32: W526–W531. doi:10.1093/nar/gkh468.
2. Schmitz C, Vernon R, Otting G, Baker D, Huber T (2012) Protein structure determination from pseudocontact shifts using ROSETTA. J Mol Biol 416: 668–677. doi:10.1016/j.jmb.2011.12.056.
3. Yagi H, Pilla KB, Maleckis A, Graham B, Huber T, et al. (2013) Three-dimensional protein fold determination from backbone amide pseudocontact shifts generated by lanthanide tags at multiple sites. Structure 21: 883–890. doi:10.1016/j.str.2013.04.001.
